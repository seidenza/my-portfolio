
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3 Oct 23 - Activity: PDEs and Separation of Variables &#8212; PHY 415 Fall 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'PHY415/2_EM/Statics/activity-sep_var';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">PHY 415 Fall 2023</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Home poage
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Syllabus and Overview of PHY 415</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../0_syllabus.html">Syllabus and Overview of PHY 415</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../1_goals.html">Course Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2_design.html">Course Design</a></li>

</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub.egr.msu.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/executablebooks/jupyter-book&urlpath=lab/tree/jupyter-book/PHY415/2_EM/Statics/activity-sep_var.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com""/github/executablebooks/jupyter-book/blob/master/PHY415/2_EM/Statics/activity-sep_var.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/PHY415/2_EM/Statics/activity-sep_var.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3 Oct 23 - Activity: PDEs and Separation of Variables</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#point-charge-potential">Point Charge Potential</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-of-a-charged-rod">Potential of a charged rod</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#laplace-s-equation">Laplace’s Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-solutions-to-laplace-s-equation">Properties of Solutions to Laplace’s Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activity-the-infinite-gutter">Activity: The Infinite Gutter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-s-trick">Fourier’s Trick</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-solution">Visualizing the Solution</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="oct-23-activity-pdes-and-separation-of-variables">
<h1>3 Oct 23 - Activity: PDEs and Separation of Variables<a class="headerlink" href="#oct-23-activity-pdes-and-separation-of-variables" title="Link to this heading">#</a></h1>
<p>As we have realized, solving field problems using vector equations is not always the best way to go about solving our problems. The integrals can be difficult to set up and the equations might be difficult, if not, impossible to solve (e.g., because there is no anti-derivative for the integrand). While we might not fully eliminate the need for vector equations, in electrostatic situations, we can posit the <a class="reference external" href="https://en.wikipedia.org/wiki/Electric_potential">electric potential</a>, <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p><strong>We changed to using <span class="math notranslate nohighlight">\(\Phi\)</span> because there are also things like <span class="math notranslate nohighlight">\(dV\)</span> – volume elements.</strong></p>
<p>The scalar field, <span class="math notranslate nohighlight">\(\Phi(\mathbf{r})\)</span> is given by Poisson’s equation as it is related to the electric field by the gradient.</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \vec{E} = \frac{\rho}{\epsilon_0} \rightarrow \vec{E} = -\nabla \Phi\]</div>
<div class="math notranslate nohighlight">
\[\nabla \cdot (-\nabla \Phi) = -\nabla^2 \Phi = \frac{\rho}{\epsilon_0}\]</div>
<div class="math notranslate nohighlight">
\[\nabla^2 \Phi = -\frac{\rho}{\epsilon_0}\]</div>
<p>As you might have seen, there is an integral form of the electric potential. This is built up from the description that we have seen for the electric field of a point charge.</p>
<div class="math notranslate nohighlight">
\[\vec{E}_{pt} = \frac{1}{4\pi\epsilon_0}\frac{q}{r^2}\hat{r} \rightarrow \Phi_{pt} = \frac{1}{4\pi\epsilon_0}\frac{q}{r}\]</div>
<p>Or more generally, for a continuous charge distribution,</p>
<div class="math notranslate nohighlight">
\[d\Phi = \frac{1}{4\pi\epsilon_0}\frac{\rho dV}{|\mathbf{r}-\mathbf{r}'|}\]</div>
<div class="math notranslate nohighlight">
\[\Phi = \frac{1}{4\pi\epsilon_0}\iiint\frac{\rho dV}{|\mathbf{r}-\mathbf{r}'|}\]</div>
<p>Much like we have done with the electric field, one can set up a forward integral formulation of the electric potential and add up the elements to find the total potential. Let’s use Python [sympy] library to illustrate this. We start with the point charge. Here <span class="math notranslate nohighlight">\(k=\frac{1}{4\pi\epsilon_0}\)</span>.</p>
<p>First, we show how to form an expression for the point charge potential.</p>
<section id="point-charge-potential">
<h2>Point Charge Potential<a class="headerlink" href="#point-charge-potential" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">init_printing</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span> <span class="nn">sympy.interactive</span> <span class="kn">import</span> <span class="n">printing</span>

<span class="c1"># Setup LaTeX printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define variables</span>
<span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k q r&#39;</span><span class="p">)</span>

<span class="c1"># Define electric potential equation for point charge</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">r</span>

<span class="c1"># Print the equation in LaTeX format</span>
<span class="n">display</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d362fdebb9dc95e239118908fda43a0abcf8379d616710377c6c7b9264cf8fef.png" src="../../../_images/d362fdebb9dc95e239118908fda43a0abcf8379d616710377c6c7b9264cf8fef.png" />
</div>
</div>
<section id="potential-of-a-charged-rod">
<h3>Potential of a charged rod<a class="headerlink" href="#potential-of-a-charged-rod" title="Link to this heading">#</a></h3>
<p>It is common to compute the electric potential of a charged rod along a line perpendicular to it along the y-axis. Let’s do this for a rod of length <span class="math notranslate nohighlight">\(L\)</span> with a uniform charge density, <span class="math notranslate nohighlight">\(\lambda\)</span>. We will assume that the rod is centered on the origin and that the axis of the rod is aligned with the <span class="math notranslate nohighlight">\(x\)</span>-axis. We can treat a tiny piece of the rod like a point charge and add things up!</p>
<p>Let’s find the electric potential at <span class="math notranslate nohighlight">\(\langle 0,y,0 \rangle\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="c1"># Define more variables</span>
<span class="n">L</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;L lambda y x&#39;</span><span class="p">)</span>

<span class="c1"># Define limits of integration for a rod of length L centered at the origin</span>
<span class="n">lower_limit</span> <span class="o">=</span> <span class="o">-</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">upper_limit</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Define the integrand for electric potential due to a uniformly charged rod</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Perform the integration</span>
<span class="n">V_rod</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">))</span>

<span class="c1"># Print the result in LaTeX format</span>
<span class="n">display</span><span class="p">(</span><span class="n">V_rod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8233fea5b68f4c18dd8ed23271ae610b6b520fc5b2458b01fe40f6694e8b44a4.png" src="../../../_images/8233fea5b68f4c18dd8ed23271ae610b6b520fc5b2458b01fe40f6694e8b44a4.png" />
</div>
</div>
<p>What’s nice is that we can change the problem quickly byt changing the location or the distribution. For example, to find the field on the end of the rod, we have to change the integrand a bit. Let’s assume we are looking at the end of the rod at <span class="math notranslate nohighlight">\(\langle x_0,0,0 \rangle\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define more variables</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">)</span>

<span class="c1"># Define the integrand for electric potential due to a uniformly charged rod</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Perform the integration</span>
<span class="n">V_rod_2</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">))</span>

<span class="c1"># Print the result in LaTeX format</span>
<span class="n">display</span><span class="p">(</span><span class="n">V_rod_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0b5b715438a05d6898606f80c737979a26a7a5bec09f23540c6aec3dcde6dac8.png" src="../../../_images/0b5b715438a05d6898606f80c737979a26a7a5bec09f23540c6aec3dcde6dac8.png" />
</div>
</div>
<p>However, this approach is typically not the best way to solve electric potential problems because they often only work for specific geometries and at certain locations. For example, consider the general location <span class="math notranslate nohighlight">\(\langle x_0,y_0,0 \rangle\)</span>. We can still use the integral approach, but we find that our solution is becoming more complicated and harder to interpret easily. It is also the case that we can (quite easily) form integrals that are not possible to compute analytically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define more variables</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;y0&#39;</span><span class="p">)</span>

<span class="c1"># Define the integrand for electric potential due to a uniformly charged rod</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Perform the integration</span>
<span class="n">V_rod_3</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">))</span>

<span class="c1"># Print the result in LaTeX format</span>
<span class="n">display</span><span class="p">(</span><span class="n">V_rod_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/33dfc441951a50773af4742f726b0dcf7233e472e952fbfed36b4a6fa8b234fd.png" src="../../../_images/33dfc441951a50773af4742f726b0dcf7233e472e952fbfed36b4a6fa8b234fd.png" />
</div>
</div>
<p>Instead, we will use the differential form of the electric potential where there are no charges, but the boundaries are set to a given potential. This is called <strong>Laplace’s equation</strong>.</p>
<p><em>Note that regardless of the approach to find the electric field we will need to eventually compute the gradient of the electric potential.</em> We will need to do that numerically later.</p>
</section>
</section>
<section id="laplace-s-equation">
<h2>Laplace’s Equation<a class="headerlink" href="#laplace-s-equation" title="Link to this heading">#</a></h2>
<p><em>Numerical solution to Laplace’s equation on an annulus</em>
<img alt="Laplace's Equation" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Laplace%27s_equation_on_an_annulus.svg/800px-Laplace%27s_equation_on_an_annulus.svg.png" /></p>
<p>While Poisson’s equation describes how the value of the local Laplacian of the electric potential is directly related to the local electric potential, there are many places where there are no charges. For example, it’s common to solve problems where the <strong>boundary conditions</strong> are set to a given potential or with a certain amount of charge, and the remaining space is empty (or free space). This doesn’t mean that an electric field is not present in that empty space, but rather that there are no charges. In this case, the problem that are solving is called <strong>Laplace’s equation</strong> - a special case of Poisson’s equation where <span class="math notranslate nohighlight">\(\rho = 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \Phi = 0\]</div>
<p>There are two important ways to go about solving these problems. The first is using separation of variables, which is a common analytical technique. The second is to use numerical methods that we will discuss later in the course. Both of these methods rely on the the following properties of the solutions to Laplace’s equation.</p>
<section id="properties-of-solutions-to-laplace-s-equation">
<h3>Properties of Solutions to Laplace’s Equation<a class="headerlink" href="#properties-of-solutions-to-laplace-s-equation" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> has no local maxima or minima except at boundaries</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> is smooth and continuous everywhere</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> is single valued</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> at a location is the average of the values of <span class="math notranslate nohighlight">\(\Phi\)</span> over the surrounding space</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> is unique. There is only one solution to Laplace’s equation for a given set of boundary conditions.</p></li>
</ol>
</section>
</section>
<section id="activity-the-infinite-gutter">
<h2>Activity: The Infinite Gutter<a class="headerlink" href="#activity-the-infinite-gutter" title="Link to this heading">#</a></h2>
<p><img alt="Infinite Gutter" src="https://i.stack.imgur.com/nHF7a.jpg" /></p>
<p>Consider a metal gutter that extends into infinitely in the <span class="math notranslate nohighlight">\(z\)</span> direction. The gutter width in the <span class="math notranslate nohighlight">\(y\)</span> direction is <span class="math notranslate nohighlight">\(a\)</span>. It is placed in the <span class="math notranslate nohighlight">\(y-z\)</span> plane and the <span class="math notranslate nohighlight">\(+x\)</span> direction is not constrained and extends to infinity (both the wall at <span class="math notranslate nohighlight">\(y=0\)</span> and <span class="math notranslate nohighlight">\(y=a\)</span>). So that Laplace’s equation applies in the region:</p>
<ol class="arabic simple">
<li><p>any <span class="math notranslate nohighlight">\(z\)</span> value</p></li>
<li><p><span class="math notranslate nohighlight">\(x &gt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(0 &lt; y &lt; a\)</span></p></li>
</ol>
<section id="boundary-conditions">
<h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h3>
<p>What uniquely determines our solution to Laplace’s equation are the boundary conditions. For this case, we are going to set all the conditions to zero except one to illustrate the way we find those unique solutions. The boundary conditions are:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\Phi(x&gt;0, y=0) = 0\)</span> Grounded</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi(x&gt;0, y=a) = 0\)</span> Grounded</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi(x=0, 0 &lt; y &lt; a) = V_0(y)\)</span> Set potential at the bottom of the gutter</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi(x\rightarrow \infty,0&lt;y&lt;a) = 0\)</span> Potential goes to zero at infinity</p></li>
</ol>
<p>Because we have infinite extent in the <span class="math notranslate nohighlight">\(z\)</span> direction, we don’t need to solve for that direction. We can assume the potential looks the same for every slice of the <span class="math notranslate nohighlight">\(x-y\)</span> plane in the region. This means we can simplify our approach:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \Phi = \nabla^2 \Phi(x,y) = 0 \longrightarrow \Phi(x,y) = X(x)Y(y)\]</div>
<p><strong>✅ Do this</strong></p>
<ol class="arabic simple">
<li><p>Using the proposed solution, use separation of variables to find ODEs for <span class="math notranslate nohighlight">\(X(x)\)</span> and <span class="math notranslate nohighlight">\(Y(y)\)</span>.</p></li>
<li><p>Solve the ODEs for <span class="math notranslate nohighlight">\(X(x)\)</span> and <span class="math notranslate nohighlight">\(Y(y)\)</span> in general. How do you choose which general solution to use in which direction?</p></li>
<li><p>Apply the boundary conditions to solve for the constants in the general solutions.</p></li>
</ol>
<p><strong>Note that applying the boundary condition for <span class="math notranslate nohighlight">\(x=a\)</span> will result in an equation of the form <span class="math notranslate nohighlight">\(V(0,y) = C'\sin(ky)\)</span> where <span class="math notranslate nohighlight">\(C'\)</span> and <span class="math notranslate nohighlight">\(k\)</span> are some constants.</strong> This is a new thing that we running up against. It requires that we use Fourier’s trick to solve for the appropriate constants. This will lead us into <a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_functions">orthgonal functions</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_series">Fourier series</a>.</p>
</section>
<section id="fourier-s-trick">
<h3>Fourier’s Trick<a class="headerlink" href="#fourier-s-trick" title="Link to this heading">#</a></h3>
<p>Fourier’s trick is just what results from integrated orthonormal functions over the domain of importance. For example, the most common version of this approach is to integrate the product of two sine functions over the domain <span class="math notranslate nohighlight">\([0,\pi]\)</span> or the equivalent in the case of a length scale <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_0^a \sin\left(\dfrac{n\pi y}{a}\right) \sin\left(\dfrac{m\pi y}{a}\right) dy = \begin{cases} 0 &amp; n \neq m \\ \dfrac{a}{2} &amp; n = m \end{cases}\end{split}\]</div>
<p>We have shown that the final form of the undetermined boundary condition is:</p>
<div class="math notranslate nohighlight">
\[\Phi(0,y) = \sum_n C_n \sin\left(\dfrac{n\pi y}{a}\right)\]</div>
<p>Let’s multiple both sides by <span class="math notranslate nohighlight">\(\sin\left(\dfrac{m\pi y}{a}\right)\)</span> and integrate over the domain <span class="math notranslate nohighlight">\([0,a]\)</span>.</p>
<div class="math notranslate nohighlight">
\[\int_0^a \Phi(0,y) \sin\left(\dfrac{m\pi y}{a}\right) dy = \sum_n C_n \int_0^a \sin\left(\dfrac{n\pi y}{a}\right) \sin\left(\dfrac{m\pi y}{a}\right) dy\]</div>
<p>The left hand side is only non-zero when <span class="math notranslate nohighlight">\(n=m\)</span>, so we use the <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker delta</a> to simplify the right hand side.</p>
<div class="math notranslate nohighlight">
\[\int_0^a \Phi(0,y) \sin\left(\dfrac{m\pi y}{a}\right) dy = \sum_n C_n \dfrac{a}{2}\delta_{nm}\]</div>
<p>We further simplify by noticing that the right hand side is only non-zero when <span class="math notranslate nohighlight">\(n=m\)</span>, so that the requirement is that the indicies are equal.</p>
<div class="math notranslate nohighlight">
\[\int_0^a \Phi(0,y) \sin\left(\dfrac{m\pi y}{a}\right) dy = C_m \dfrac{a}{2}\]</div>
<p>Turn the equation around to solve for <span class="math notranslate nohighlight">\(C_m\)</span>, and we have an integral expression.</p>
<div class="math notranslate nohighlight">
\[C_m = \dfrac{2}{a}\int_0^a \Phi(0,y) \sin\left(\dfrac{m\pi y}{a}\right) dy\]</div>
<p><strong>✅ Do this</strong></p>
<ol class="arabic simple">
<li><p>Let <span class="math notranslate nohighlight">\(\Phi(0,y) = V_0\)</span>, which is the potential at the bottom of the gutter. Use the integral expression to find <span class="math notranslate nohighlight">\(C_m\)</span>.</p></li>
<li><p>Combined with your prior work, write down the solution for the electric potential in the gutter. What do you notice about the solution? Can you visualize it?</p></li>
</ol>
</section>
<section id="visualizing-the-solution">
<h3>Visualizing the Solution<a class="headerlink" href="#visualizing-the-solution" title="Link to this heading">#</a></h3>
<p>We often find from these analyses that we produce infinite series solutions like this for the potential (note this is for a different problem):</p>
<div class="math notranslate nohighlight">
\[\Phi(x,y) = \sum_{n=1,3,5,\dots}^{\infty} \dfrac{4V_0}{n\pi} \sin\left(\dfrac{n\pi x}{a}\right) e^{-\frac{n\pi y}{a}}\]</div>
<p>This solution is for the domain <span class="math notranslate nohighlight">\(0&lt; x&lt; a\)</span> and infinite <span class="math notranslate nohighlight">\(y\)</span> extent. It’s a 90 degree-turned version of the problem you solved earlier.</p>
<p><strong>✅ Do this</strong></p>
<p>Create a 3D figure of the electric potential of this situation.</p>
<ol class="arabic simple">
<li><p>You will need to create a mesh grid of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> values.</p></li>
<li><p>You will need to create a function that sums the series for a given <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> value.</p></li>
<li><p>You will need to truncate the series after some terms (you can’t sum to infinity).</p></li>
<li><p>You will need to plot the result using <code class="docutils literal notranslate"><span class="pre">plot_surface</span></code> from <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># Gap width</span>
<span class="n">V0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Potential difference</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set size of space</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span> 
<span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">steps</span><span class="p">)</span> 

<span class="c1"># Create a mesh</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>

<span class="c1"># Function to calculate the electric potential at a given (x, y)</span>
<span class="k">def</span> <span class="nf">electric_potential</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1">## Compute Phi at (x, y) due to each term in the series</span>
    <span class="c1">## Write the summation up to the &#39;terms&#39; number of terms</span>
    
    
    <span class="k">return</span> <span class="n">phi</span>

<span class="c1"># Calculate the electric potential on the mesh grid</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">## Write the routine to calculate the electric potential on the mesh</span>
<span class="c1">## You will need to step through each point in the mesh and call the</span>
<span class="c1">## electric_potential() function to calculate the electric potential</span>

<span class="c1"># Create a 3D plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="c1"># Plot the electric potential surface</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Electric Potential&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Electric Potential&#39;)
</pre></div>
</div>
<img alt="../../../_images/f8b13a4b03d7ce57d8ac8c86a0cdafddde3b8f4528f04de7d7436719118e5403.png" src="../../../_images/f8b13a4b03d7ce57d8ac8c86a0cdafddde3b8f4528f04de7d7436719118e5403.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./PHY415/2_EM/Statics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#point-charge-potential">Point Charge Potential</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-of-a-charged-rod">Potential of a charged rod</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#laplace-s-equation">Laplace’s Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-solutions-to-laplace-s-equation">Properties of Solutions to Laplace’s Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activity-the-infinite-gutter">Activity: The Infinite Gutter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-s-trick">Fourier’s Trick</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-solution">Visualizing the Solution</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Caroline Seidenzahl
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>